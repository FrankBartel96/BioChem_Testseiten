<!DOCTYPE html>
<html lang="de">
<head>
    <meta charset="UTF-8 ">
    <!--  <meta name="viewport" content="width=device-width, initial-scale=1.0">  -->
    <!-- /*Zoom*/-->
    <meta name="viewport"
          content="width=device-width, initial-scale=1.0, minimum-scale=0.5, maximum-scale=3.0, user-scalable=yes">

    <title>Pflanzenfamilien Drag & Drop</title>
    <style>
        body {
            font-family: -apple-system, BlinkMacSystemFont, "San Francisco", Arial, sans-serif;
            background: #F6F8E2;
            text-align: center;
            display: flex;
            justify-content: center;
            align-items: center;
            margin: 0;
            padding: 20px;
        }

        h1 {
            color: #333;
            font-weight: 600;
        }

        .container {
            width: 70%;
            background: #EEE8AA;
            /*  height: 700px; */
            display: inline-flex;
            justify-content: center;
            gap: 20px;
            margin-top: 20px;
            align-content: center;
        }

        .bldserie {
            background: white;
            /*flex-direction: row;    */



            padding: 3px;
            border-radius: 12px;
            box-shadow: 0 4px 10px rgba(0, 0, 0, 0.1);
            width: 220px; /*breite der wei√üen Fl√§che um bilder*/
        }

        .dropzone {
            width: 120px; /*breite der  bilder*/
            height: 100px;
            border: 2px dashed #ccc;
            border-radius: 10px;
            margin: 5px auto;
            /* flex-direction: row; */



            justify-content: center;
            align-items: center;
            background: #fafafa;
        }

        .image {
            width: 100px;
            height: auto;
            /* flex-direction: row; */


            cursor: grab;
            border-radius: 8px;
            transition: transform 0.2s ease;
        }

            .image:active {
                transform: scale(1.05);
            }

        .btn {
            background: #007aff;
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 8px;
            font-size: 16px;
            cursor: pointer;
            margin-top: 20px;
            transition: background 0.2s;
        }

            .btn:hover {
                background: #005ecb;
            }

        .correct {
            background: #34c759 !important;
        }

        .incorrect {
            background: #ff3b30 !important;
        }

        #images-container {
            display: inline-flex;
            justify-content: center;
            flex-wrap: wrap;
            gap: 10px;
            margin-top: 10px;
            max-width: 70%; /*Breite der unteren Bildleiste*/
            max-height: 70%;
        }
    </style>
</head>
<body>

    <div class="container">

        <table>
            <tr>
                <td colspan="1">
                    <h2> Pflanzenfamilien</h2> <h3>Ordne die Bilder richtig zu. Ziehe dazu die Bilder hierher:</h3>
                    <button class="btn" onclick="checkResults()">Auswerten</button>
                    <button class="btn" onclick="location.reload()">Seite neu laden</button>
                    <button class="btn" onclick="openQRCode()">QR-Code anzeigen</button>

                </td>
            </tr>

            <tr>

                <td>

                    <div class="container">

                        <div class="bldserie" data-bldserie="1">
                            <h4>Kreuzbl√ºtler </h4>
                            <div class="dropzone" data-position="1">Bl√ºte</div>
                            <div class="dropzone" data-position="2">Bl√ºtendiagramm </div>
                            <div class="dropzone" data-position="3">Bl√ºtenformel</div>
                            <div class="dropzone" data-position="4">Fruchtform</div>
                            <div class="dropzone" data-position="5">Vertreter</div>
                        </div>

                        <!-- Bilderserie 2 -->
                        <div class="bldserie" data-bldserie="2">
                            <h4>Rosengew√§chse </h4>
                            <div class="dropzone" data-position="1">Bl√ºte</div>
                            <div class="dropzone" data-position="2">Bl√ºtendiagramm</div>
                            <div class="dropzone" data-position="3">Bl√ºtenformel</div>
                            <div class="dropzone" data-position="4">Fruchtform</div>
                            <div class="dropzone" data-position="5">Vertreter</div>
                        </div>


                        <!-- Bilderserie 3 -->
                        <div class="bldserie" data-bldserie="3">
                            <h4>Lippenbl√ºtler </h4>
                            <div class="dropzone" data-position="1">Bl√ºte</div>
                            <div class="dropzone" data-position="2">Bl√ºtendiagramm</div>
                            <div class="dropzone" data-position="3">Bl√ºtenformel</div>
                            <div class="dropzone" data-position="4">Fruchtform</div>
                            <div class="dropzone" data-position="5">Vertreter</div>
                        </div>




                        <div class="bldserie" data-bldserie="4">
                            <h4>Schmetterlingsbl√ºtler </h4>
                            <div class="dropzone" data-position="1">Bl√ºte</div>
                            <div class="dropzone" data-position="2">Bl√ºtendiagramm</div>
                            <div class="dropzone" data-position="3">Bl√ºtenformel</div>
                            <div class="dropzone" data-position="4">Fruchtform</div>
                            <div class="dropzone" data-position="5">Vertreter</div>
                        </div>

                        <div class="bldserie" data-bldserie="5">
                            <h4>Korbbl√ºtler </h4>
                            <div class="dropzone" data-position="1">Bl√ºte</div>
                            <div class="dropzone" data-position="2">Bl√ºtendiagramm</div>
                            <div class="dropzone" data-position="3">Bl√ºtenformel</div>
                            <div class="dropzone" data-position="4">Fruchtform</div>
                            <div class="dropzone" data-position="5">Vertreter</div>
                        </div>

                        <div class="bldserie" data-bldserie="6">
                            <h4> Liliengew√§chse </h4>
                            <div class="dropzone" data-position="1">Bl√ºte</div>
                            <div class="dropzone" data-position="2">Bl√ºtendiagramm</div>
                            <div class="dropzone" data-position="3">Bl√ºtenformel</div>
                            <div class="dropzone" data-position="4">Fruchtform</div>
                            <div class="dropzone" data-position="5">Vertreter</div>
                        </div>

                    </div>

                </td>
            </tr>

            <!--


                    <textarea>

            https://www.gida.de/testcenter/biologie/bio-dvd036/aufgabe_02.htm
            https://www.gida.de/testcenter/biologie/#36
            https://www.digitalefolien.de/biologie/pflanzen/aufbau/frucht.html
            Lippis: K5 C5-0 A5+5 G5-4 Spaltfrucht/KLausen, Basilikum, Minze, Rosmarin, Thymian, Salbei, Lavendel
            Kruzer: K2+2 C4 A2+4 G4   Schote Ackersenf,Brokkoli, Blumenkohl, Wei√ükohl, Raps, Kohl, Senf, Rettich, Kresse, Hirtent√§schel
            Schmmetter : K4 C4 A2+4 G2 H√ºlse  Erbsen, Bohnen, Linsen, Klee
            Doldis: K5 C5 A5 G (2) Spaltfrucht/Doppelach√§ne Dill, Fenchel, Koriander, K√ºmmel, Liebst√∂ckel, Petersilie, Karotte, Selleie
            Korbis: (‚Üì)K(‚àû) [C(5)A(5)] G(2) Nuss (Ach√§ne) Sonnenblume, G√§nsebl√ºmchen, Margerite, Kamille
            Liliengew√§chse:: P3+3 A3+3 G(3)  Kapsel  Tulpe,Lilie, Gelbstern, Kaiserkrone, Traubenhyazinthe
            Rosen:K5 C5 A‚àû G1-‚àû    Kernfrucht Balgfr√ºchte, N√ºsschen, Sch(t)einfr√ºchte, Steinfr√ºchte
             Wei√üdorn, √Ñpfel, Birnen, Kirschen, Pflaumen, Erdbeeren, Himbeeren, Brombeeren
            </textarea>
                </td>
            </tr>
             -->



            <tr>
                <td align="center">
                    <div id="images-container">
                        <!-- ZufÔøΩllig sortierte Bilder werden hier eingefÔøΩgt -->
                    </div>
                    <!--   <button class="btn" onclick="checkResults()">Auswerten</button>-->
                </td>
            </tr>


        </table>


    </div>

    <script>
        const imagesContainer = document.getElementById("images-container");
        let imagesArray = [];

        // Bilder in Array speichern ; Anzahl Bildserien; je 5 Bilder
        for (let bldserie = 1; bldserie <= 6; bldserie++) {
            for (let i = 1; i <= 5; i++) {
                imagesArray.push({
                    src: `./images/Bldserie/bldserie${bldserie}_${i}.jpg`,
                    bldserie: bldserie,
                    position: i
                });
            }
        }

        // Fisher-Yates-Shuffle
        function shuffleArray(array) {
            for (let i = array.length - 1; i > 0; i--) {
                const j = Math.floor(Math.random() * (i + 1));
                [array[i], array[j]] = [array[j], array[i]];
            }
        }

        shuffleArray(imagesArray);

        // Bilder unten einf¸gen
        imagesArray.forEach(image => {
            let img = document.createElement("img");
            img.src = image.src;
            img.classList.add("image");
            img.draggable = true;
            img.dataset.bldserie = image.bldserie;
            img.dataset.position = image.position;
            img.addEventListener("dragstart", dragStart);
            imagesContainer.appendChild(img);
        });

        // Drag & Drop Logik
        function dragStart(event) {
            event.dataTransfer.setData("text/plain", null); // Safari-Fix
            event.dataTransfer.setData("elementId", event.target.id || assignTempId(event.target));
        }

        function assignTempId(el) {
            const tempId = "img_" + Math.random().toString(36).substr(2, 9);
            el.id = tempId;
            return tempId;
        }

        document.querySelectorAll(".dropzone").forEach(zone => {
            zone.addEventListener("dragover", event => event.preventDefault());

            zone.addEventListener("drop", event => {
                event.preventDefault();
                const elementId = event.dataTransfer.getData("elementId");
                const img = document.getElementById(elementId);

                // Wenn bereits ein Bild vorhanden ist, abbrechen (oder ersetze es hier)
                if (zone.children.length > 0) return;

                // Text entfernen
                zone.textContent = "";

                // Bild in neues Feld verschieben
                zone.appendChild(img);
            });
        });

        // Auch das untere Bildfeld (imagesContainer) als Dropzone aktivieren,
        // damit man Bilder wieder "zur¸cklegen" kann.
        imagesContainer.addEventListener("dragover", event => event.preventDefault());
        imagesContainer.addEventListener("drop", event => {
            event.preventDefault();
            const elementId = event.dataTransfer.getData("elementId");
            const img = document.getElementById(elementId);
            imagesContainer.appendChild(img);
        });

        function checkResults() {
            document.querySelectorAll(".dropzone").forEach(zone => {
                zone.classList.remove("correct", "incorrect"); // Reset Farben
                if (zone.children.length > 0) {
                    const img = zone.children[0];
                    const correctSerie = zone.parentElement.dataset.bldserie;
                    const correctPosition = zone.dataset.position;

                    if (img.dataset.bldserie === correctSerie && img.dataset.position === correctPosition) {
                        zone.classList.add("correct");
                    } else {
                        zone.classList.add("incorrect");
                    }
                }
            });
        }
    </script>



    <script>
        function openQRCode() {
            const currentUrl = window.location.href;
            const qrWin = window.open("", "_blank", "width=520,height=600,resizable=yes,scrollbars=no");

            qrWin.document.write(`
                   <html lang="de">
                   <head>
                     <meta charset="UTF-8">
                     <title>QR-Code</title>
                     <style>
                       body {
                         font-family: Arial, sans-serif;
                         text-align: center;
                         background: #fff;
                         padding: 30px;
                       }
                       #qrcode { margin-top: 40px; }
                       button {
                         margin-top: 40px;
                         background: #0071e3;
                         color: #fff;
                         border: none;
                         border-radius: 10px;
                         font-size: 16px;
                         padding: 10px 20px;
                         cursor: pointer;
                       }
                       button:hover { background: #005bb5; }
                     </style>
                   </head>
                   <body>
                     <h2>QR-Code zu dieser Seite</h2>
                     <div id="qrcode"></div>
                     <button onclick="window.close()">Fenster schlie√É≈∏en</button>
                     <script src="libs/qrcode.min.js"><\/script>
                     <script>
                       window.addEventListener('load', function() {
                         new QRCode(document.getElementById("qrcode"), {
                           text: "${currentUrl}",
                           width: 220,
                           height: 220,
                           correctLevel: QRCode.CorrectLevel.H
                         });
                       });
                     <\/script>
                   </body>
                   </html>
                 `);

            qrWin.document.close();
        }
    </script>



</body>
</html>